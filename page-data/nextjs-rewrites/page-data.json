{"componentChunkName":"component---src-templates-blog-template-js","path":"/nextjs-rewrites/","result":{"data":{"cur":{"id":"9d5117ef-b568-51ce-8401-9d69b986a00d","html":"<p>next.config.js에서 rewrites 옵션을 사용하면 next 서버가 일종의 proxy 역할을 하도록 구현할 수 있다.</p>\n<p>요청 url을 숨기고 싶을 때 따로 API를 구현하지 않아도 되고 머리 아픈 CORS 에러도 간단하게 해결할 수 있어서 종종 사용하는데, url에 <code class=\"language-text\">query parameter</code>를 적용하다가 삽질했던 기록을 남겨본다.</p>\n<h2 id=\"path-parameter-제대로-이해하기\" style=\"position:relative;\"><a href=\"#path-parameter-%EC%A0%9C%EB%8C%80%EB%A1%9C-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0\" aria-label=\"path parameter 제대로 이해하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>path parameter 제대로 이해하기</h2>\n<p><code class=\"language-text\">/aladin-api?QueryType=Bestseller</code>와 같은 요청을 처리하고 싶을 때, 해당 요청의 path는 <code class=\"language-text\">/aladin-api</code>이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">rewrites</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        source<span class=\"token operator\">:</span> <span class=\"token string\">'/aladin-api'</span><span class=\"token punctuation\">,</span>\n        destination<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">ALADIN_OPEN_API</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/api</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>source 필드에 정규표현식으로 query parameter key를 매치해보려고 시도하면 안된다.. 404 만남!😅</p>\n<h2 id=\"has-사용하기\" style=\"position:relative;\"><a href=\"#has-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\" aria-label=\"has 사용하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>has 사용하기</h2>\n<p>대신 특정 query parameter가 포함되어 있는지 확인하기 위해 사용할 수 있는 필드가 있는데, 바로 <code class=\"language-text\">has</code>이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">rewrites</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        source<span class=\"token operator\">:</span> <span class=\"token string\">'/aladin-api'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token comment\">/** /aladin-api?QueryType=Bestseller 요청에 매치된다. */</span>\n        has<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n          <span class=\"token punctuation\">{</span>\n            type<span class=\"token operator\">:</span> <span class=\"token string\">'query'</span><span class=\"token punctuation\">,</span>\n            key<span class=\"token operator\">:</span> <span class=\"token string\">'QueryType'</span><span class=\"token punctuation\">,</span>\n            value<span class=\"token operator\">:</span> <span class=\"token string\">'Bestseller'</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        destination<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">ALADIN_OPEN_API</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/api?QueryType=Bestseller</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>query parameter의 value 값을 그대로 destination에 넣고 싶다면, named capture group을 사용해야 한다. (query key를 변수처럼 사용할 수는 없다.)</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">rewrites</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        source<span class=\"token operator\">:</span> <span class=\"token string\">'/aladin-api'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token comment\">/** /aladin-api?QueryType=* 요청에 매치된다. */</span>\n        has<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n          <span class=\"token punctuation\">{</span>\n            type<span class=\"token operator\">:</span> <span class=\"token string\">'query'</span><span class=\"token punctuation\">,</span>\n            key<span class=\"token operator\">:</span> <span class=\"token string\">'QueryType'</span><span class=\"token punctuation\">,</span>\n            value<span class=\"token operator\">:</span> <span class=\"token string\">'(?&lt;QueryType>.*)'</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        destination<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">ALADIN_OPEN_API</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/api?QueryType=:QueryType</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">has</code>는 query parameter 뿐만 아니라 header나 cookie에 특정 값이 포함되어 있는지 확인할 때 사용할 수도 있다.</p>\n<h2 id=\"주의할-점\" style=\"position:relative;\"><a href=\"#%EC%A3%BC%EC%9D%98%ED%95%A0-%EC%A0%90\" aria-label=\"주의할 점 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>주의할 점</h2>\n<p>has 필드로 전달되는 모든 query key가 존재해야지만 매칭된다는 점에 주의해야 한다. (아주.. 섬세한 친구이다..🫠)</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">module<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">async</span> <span class=\"token function\">rewrites</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        source<span class=\"token operator\">:</span> <span class=\"token string\">'/aladin-api'</span><span class=\"token punctuation\">,</span>\n        <span class=\"token comment\">/**\n         * /aladin-api?QueryType=*&amp;Cover=* 요청에 매치된다.\n         * /aladin-api?Cover=*&amp;QueryType=* (O)\n         * /aladin-api?QueryType=* (X)\n         * /aladin-api?Cover=* (X)\n         */</span>\n        has<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n          <span class=\"token punctuation\">{</span>\n            type<span class=\"token operator\">:</span> <span class=\"token string\">'query'</span><span class=\"token punctuation\">,</span>\n            key<span class=\"token operator\">:</span> <span class=\"token string\">'QueryType'</span><span class=\"token punctuation\">,</span>\n            value<span class=\"token operator\">:</span> <span class=\"token string\">'(?&lt;QueryType>.*)'</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">{</span>\n            type<span class=\"token operator\">:</span> <span class=\"token string\">'query'</span><span class=\"token punctuation\">,</span>\n            key<span class=\"token operator\">:</span> <span class=\"token string\">'Cover'</span><span class=\"token punctuation\">,</span>\n            value<span class=\"token operator\">:</span> <span class=\"token string\">'(?&lt;Cover>.*)'</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        destination<span class=\"token operator\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>process<span class=\"token punctuation\">.</span>env<span class=\"token punctuation\">.</span><span class=\"token constant\">ALADIN_OPEN_API</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">/api?QueryType=:QueryType&amp;Cover=:Cover</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2 id=\"마무리\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EB%AC%B4%EB%A6%AC\" aria-label=\"마무리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>마무리</h2>\n<p>간단한 API에서 활용하기에는 문제가 없어 보이지만, 더 범용적으로 사용되는 API라면 rewrites 옵션만으로는 분기 처리가 쉽지 않아 별도의 API를 구축하는게 더 효율적일 것 같다.</p>\n<h2 id=\"참고\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0\" aria-label=\"참고 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고</h2>\n<ul>\n<li><a href=\"https://nextjs.org/docs/pages/api-reference/next-config-js/rewrites#header-cookie-and-query-matching\">Next.js 공식문서 - rewrites</a></li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#path-parameter-%EC%A0%9C%EB%8C%80%EB%A1%9C-%EC%9D%B4%ED%95%B4%ED%95%98%EA%B8%B0\">path parameter 제대로 이해하기</a></li>\n<li><a href=\"#has-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\">has 사용하기</a></li>\n<li><a href=\"#%EC%A3%BC%EC%9D%98%ED%95%A0-%EC%A0%90\">주의할 점</a></li>\n<li><a href=\"#%EB%A7%88%EB%AC%B4%EB%A6%AC\">마무리</a></li>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0\">참고</a></li>\n</ul>\n</div>","excerpt":"next.config.js에서 rewrites 옵션을 사용하면 next 서버가 일종의 proxy 역할을 하도록 구현할 수 있다. 요청 url을 숨기고 싶을 때 따로 API를 구현하지 않아도 되고 머리 아픈 CORS 에러도 간단하게 해결할 수 있어서 종종 사용하는데, url에 를 적용하다가 삽질했던 기록을 남겨본다. path parameter 제대로 이해하기 와 같은 요청을 처리하고 싶을 때, 해당 요청의 path는 이다. source 필드에 정규표현식으로 query parameter key를 매치해보려고 시도하면 안된다.. 404 만남!😅 has 사용하기 대신 특정 query parameter가 포함되어 있는지 확인하기 위해 사용할 수 있는 필드가 있는데, 바로 이다. query parameter의 value 값을 그대로 destination에 넣고 싶다면, named capture group을 사용해야 한다. (query key를 변수처럼 사용할 수는 없다.) 는 query pa…","frontmatter":{"date":"January 22, 2024","title":"Next.js rewrites 옵션에서 query parameter 사용하기","categories":"프론트엔드 Next.js","author":"Fry","emoji":"📱"},"fields":{"slug":"/nextjs-rewrites/"}},"next":{"id":"dae39859-9ee0-5796-9909-3bf900e87164","html":"<p>이것저것 다양한 기술들을 사용해볼 겸 <a href=\"https://fryfolio.vercel.app/\">인터렉티브한 웹 포트폴리오</a>를 만들고 있다! 어느정도 구현된 포트폴리오를 <code class=\"language-text\">PWA</code>로 만들어봤는데, 그 과정을 기록해보려고 한다.</p>\n<h2 id=\"pwa-progressive-web-apps\" style=\"position:relative;\"><a href=\"#pwa-progressive-web-apps\" aria-label=\"pwa progressive web apps permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>PWA (Progressive Web Apps)</h2>\n<p><a href=\"https://web.dev/learn/pwa\">구글 PWA 학습 가이드</a>를 차근차근 읽어보면서 PWA가 어떤 기술인지, 왜 적용하면 좋은지를 이해할 수 있었다. 웹의 접근성과 네이티브 앱의 안정성, 성능을 동시에 가져갈 수 있기 때문에 사용자에게 훨씬 좋은 웹앱 경험을 제공할 수 있다. PWA의 이점을 극대화하려면 서비스워커와 다양한 캐싱 전략 등을 적용해보는 것이 좋을 것 같다.</p>\n<p>사실 지극히 개인적인 포트폴리오 사이트를 PWA로 만드는 것이 과하다는 생각이 들긴 하지만, 시도해보기 딱 적당한 사이즈의 프로젝트라 도전해봤다. 🤓</p>\n<blockquote>\n<p><strong>2023.11.02 - UPDATE</strong></p>\n<p>서비스 워커가 등록되지 않아 <code class=\"language-text\">next-pwa</code> 레포 이슈를 확인해봤더니 pages를 기준으로 동작하는 라이브러리이기에 app router와 호환성 문제가 있는 것 같았고, 라이브러리의 유지보수는 이뤄지지 않고 있었다.</p>\n<p>해결 방법으로는 next config를 직접 수정하거나 다른 사람이 포크 후 유지보수하고 있는 라이브러리 <a href=\"https://github.com/DuCanhGH/next-pwa\">@ducanh2912/next-pwa</a> 를 사용하는 방법이 있다.</p>\n<p>현재는 프로젝트에서 해당 패키지를 제거하고, 직접 서비스 워커를 등록했다.</p>\n<ul>\n<li><a href=\"https://github.com/shadowwalker/next-pwa/issues/424#issuecomment-1332258575\">관련 이슈</a></li>\n</ul>\n</blockquote>\n<h2 id=\"1-next-pwa-패키지-설치\" style=\"position:relative;\"><a href=\"#1-next-pwa-%ED%8C%A8%ED%82%A4%EC%A7%80-%EC%84%A4%EC%B9%98\" aria-label=\"1 next pwa 패키지 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. next-pwa 패키지 설치</h2>\n<p>Next.js 환경에서 PWA 플러그인들을 편리하게 사용하기 위해 <a href=\"https://github.com/shadowwalker/next-pwa\">next-pwa</a> 패키지를 설치한다. yarn berry zero install 환경에서 설치를 진행했다. (Next.js 프로젝트는 이미 세팅되어 있는 상태이다.)</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> next-pwa</code></pre></div>\n<h2 id=\"2-next-config-설정\" style=\"position:relative;\"><a href=\"#2-next-config-%EC%84%A4%EC%A0%95\" aria-label=\"2 next config 설정 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. next config 설정</h2>\n<p><a href=\"https://github.com/shadowwalker/next-pwa#install\">next-pwa</a>에서 설명하고 있는 것 처럼 프로젝트에서는 Next.js 9 버전 이상을 사용하고 있기 때문에 <code class=\"language-text\">next.config.js</code> 파일을 다음과 같이 수정해주었다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> withPWA <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'next-pwa'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  dest<span class=\"token operator\">:</span> <span class=\"token string\">'public'</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/** @type {import('next').NextConfig} */</span>\n<span class=\"token keyword\">const</span> nextConfig <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// next.js config</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nmodule<span class=\"token punctuation\">.</span>exports <span class=\"token operator\">=</span> <span class=\"token function\">withPWA</span><span class=\"token punctuation\">(</span>nextConfig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>그리고 빌드를 해보면</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> build</code></pre></div>\n<p><code class=\"language-text\">/public</code> 내부에 <code class=\"language-text\">workbox-*.js</code>와 <code class=\"language-text\">sw.js</code> 파일이 자동으로 생성되는 것을 확인할 수 있다.</p>\n<h2 id=\"3-manifest-파일과-아이콘-추가\" style=\"position:relative;\"><a href=\"#3-manifest-%ED%8C%8C%EC%9D%BC%EA%B3%BC-%EC%95%84%EC%9D%B4%EC%BD%98-%EC%B6%94%EA%B0%80\" aria-label=\"3 manifest 파일과 아이콘 추가 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. manifest 파일과 아이콘 추가</h2>\n<blockquote>\n<p>웹 앱 매니페스트는 웹 콘텐츠를 운영체제에서 앱으로 표시하는 방법을 브라우저에 알려주는 파일입니다. 매니페스트에는 앱 이름, 아이콘, 테마 색상과 같은 기본 정보, 원하는 방향 및 앱 바로가기와 같은 고급 환경설정, 스크린샷과 같은 카탈로그 메타데이터가 포함될 수 있습니다.</p>\n<p><em>출처: <a href=\"https://web.dev/learn/pwa/web-app-manifest?hl=ko\">https://web.dev/learn/pwa/web-app-manifest?hl=ko</a></em></p>\n</blockquote>\n<h3 id=\"생성하기\" style=\"position:relative;\"><a href=\"#%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0\" aria-label=\"생성하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>생성하기</h3>\n<p>앱 아이콘으로 사용할 <code class=\"language-text\">512 x 512</code> 사이즈의 <code class=\"language-text\">png</code> 이미지를 준비한 후, 아래 Generator를 활용해서 manifest 파일과 사이즈별 아이콘들을 만들었다.</p>\n<ul>\n<li><a href=\"https://www.simicart.com/manifest-generator.html/\">Manifest Generator</a></li>\n<li><a href=\"https://tools.crawlink.com/tools/pwa-icon-generator/\">PWA Icon Generator</a></li>\n</ul>\n<h3 id=\"저장하기\" style=\"position:relative;\"><a href=\"#%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0\" aria-label=\"저장하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>저장하기</h3>\n<p>app router를 사용하고 있는데, <a href=\"https://nextjs.org/docs/app/api-reference/file-conventions/metadata/manifest\">Next.js 공식문서</a>에서 manifest 파일은 <code class=\"language-text\">app</code> 디렉토리 최상단에 위치시키라고 설명하고 있다.</p>\n<p>아이콘은 <code class=\"language-text\">/public/icons/pwa-icons</code> 디렉토리 내부에 저장했다. 원하는 경로에 아이콘들을 저장하고, manifest 파일 icons의 경로만 잘 지정해주면 될 것 같다. public 폴더가 절대경로의 시작임을 주의해서!</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Fryfolio\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"short_name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Fryfolio\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"description\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"김규란 - Frontend Developer\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"theme_color\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"#ffc211\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"background_color\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"#ffffff\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"display\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"standalone\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"scope\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"./\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"start_url\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"./\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"icons\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"src\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"/icons/pwa-icons/icon-72x72.png\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"sizes\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"72x72\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"image/png\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"purpose\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"maskable any\"</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    ...\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2 id=\"4-metadata-제공\" style=\"position:relative;\"><a href=\"#4-metadata-%EC%A0%9C%EA%B3%B5\" aria-label=\"4 metadata 제공 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. metadata 제공</h2>\n<p>이제 manifest와 같은 메타 데이터가 제공될 수 있도록 관련 태그를 작성해야한다.</p>\n<p>그런데 Next.js의 <a href=\"https://nextjs.org/docs/app/api-reference/file-conventions/metadata\">metadata 관련 문서</a>를 읽어보니, <code class=\"language-text\">app</code> 디렉토리에 특정 컨벤션의 파일이 존재하면 자동으로 <code class=\"language-text\">&lt;head /></code> 내부에 관련 태그들을 삽입한다는 것을 알 수 있었다. 그래서 manifest 관련 태그를 따로 작성하지 않아도 manifest 파일의 정보가 잘 제공된 것을 확인할 수 있다. (편..편하다!😲)</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 77.77777777777777%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAADO0lEQVQ4y41Ty27bRhTloq4KJHAV2K1YFGib6OGdI1m2YTtG0sabwED7AzaCaOM/KPoF3cSL9B+67LrLblsEbhatUyS1qNHDpMS3KFKURGqGp8OH5SDwogMczr1D3jP33HspbJcqX9ZrxZMnhwfP9h/sN+7frzXqm1uNytpao1gsZig1SuVyo1wuNSqVcqPC7WTnKJfuNe7e/erZ2lrlZH19vSbsbW8/PXj8EIeHT3Bw8BjffP0Ijx7uo76xgXq9jq2tLWxu1rlfQ622gWq1imqtlu7VDezs7mNv7wF2dnaxu7v3k/DX778e6a0zmO1XwUg5p6PBv9TRe9SxTWqaJpVlmWqqQvs9iZ7/I1HS6dMLqU3bHZmS7oA2uyZVBmYgKyrOX795LnSar48QegCbUiCKwB/vYj6fL+yLthZplr/w45XZcw44Q/tUuGi2jrNTyqLkI0SMgXGk36eLE8M0Dfi+D8bPfX+CoePAGbmRNx7TIAihasapIDWbxwlJFNH0zii5EunZgpTx2ySphX5/kPhBEMD1PAxULRqoKlV1G+dv2pxQko6zIJpKiDLhKVEUXWfabrehaXpCHiWSGLyxH439CR2PfXS73fcI07okBUiedI5r0eABPSj9PqbTGcZcehCGVwE0fm8Y5g0ZxhnFEo0zsD9OwFo/J2SUUqiqxutoJf5sFvA6ejGiLBa6rt9ESFPCv38EflkF/e1bsEWGXfAxSuzpdIrJZIownMdhNKa4kTCuWdIE5y3on9+DaS8XsmPJvd5l1iSWZBkEs3ckG+8TXvUja0gGZJ1XFIV3VYWmG2iRDoYjD6MJjWw3oK43Qbd3eSo0m82jbDzCOL1r8F6yOQdNfN5RphsG4zPH+LiwoeMy250xyw2Z6Yah7YXoyYPnAiHkKf7ncpwRPG+MCa9fvLs+n0V/DsebYs6bNhzaL4RXZy+/sy1TtSxL4iAxVFUlV7ZlaMTWL4kmE9JqEcL/b6LpOpGVPml1Lkmv+5Z0ZKOpG5bGy/eD8IEg5PLLtwr5fF68wsrKSmZ/LOZv58R8ThDv3F4Sl5Y+FJeXl8VCoSB+Jori56s58V5eEItffFr4ZPWOmMt9dOs/9EEKLl6JGiMAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"chrome application 탭에서 manifest 정보 확인\"\n        title=\"chrome application 탭에서 manifest 정보 확인\"\n        src=\"/static/4e3182b7dd0ca2154ef0a3a92d2384a3/37523/chrome-application-manifest.png\"\n        srcset=\"/static/4e3182b7dd0ca2154ef0a3a92d2384a3/e9ff0/chrome-application-manifest.png 180w,\n/static/4e3182b7dd0ca2154ef0a3a92d2384a3/f21e7/chrome-application-manifest.png 360w,\n/static/4e3182b7dd0ca2154ef0a3a92d2384a3/37523/chrome-application-manifest.png 720w,\n/static/4e3182b7dd0ca2154ef0a3a92d2384a3/302a4/chrome-application-manifest.png 1080w,\n/static/4e3182b7dd0ca2154ef0a3a92d2384a3/07a9c/chrome-application-manifest.png 1440w,\n/static/4e3182b7dd0ca2154ef0a3a92d2384a3/78ed4/chrome-application-manifest.png 2566w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<h3 id=\"아이콘\" style=\"position:relative;\"><a href=\"#%EC%95%84%EC%9D%B4%EC%BD%98\" aria-label=\"아이콘 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>아이콘</h3>\n<p>favicon은 이미 적용되어 있고, iOS 아이콘을 적용하기 위해 <code class=\"language-text\">app</code> 디렉토리 최상단에 <code class=\"language-text\">appple-icon.png</code> 파일을 하나 더 두었다. <a href=\"https://nextjs.org/docs/app/api-reference/file-conventions/metadata/app-icons#apple-icon\">(참고)</a></p>\n<h3 id=\"스플래쉬-스크린\" style=\"position:relative;\"><a href=\"#%EC%8A%A4%ED%94%8C%EB%9E%98%EC%89%AC-%EC%8A%A4%ED%81%AC%EB%A6%B0\" aria-label=\"스플래쉬 스크린 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>스플래쉬 스크린</h3>\n<p>넷플릭스 촤라락.. 하는 것처럼 멋진 스플래쉬 화면을 만들고 싶었지만.. PWA로 동작하는게 빨리 보고싶어서 아이콘으로 <a href=\"https://appsco.pe/developer/splash-screens\">iOS Splash Screen Generator</a>를 활용해서 후다닥 만들었다.</p>\n<p>위 사이트에서는 디바이스 크기별 태그들을 바로 복사해서 사용할 수 있게 제공해준다.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span>\n  <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>splashscreens/iphone5_splash.png<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">media</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>apple-touch-startup-image<span class=\"token punctuation\">\"</span></span>\n<span class=\"token punctuation\">/></span></span>\n...</code></pre></div>\n<p>하지만 Next.js app router를 사용할 때는 <code class=\"language-text\">app/layout.tsx</code> 파일 내부에 <code class=\"language-text\">metatdata</code>를 통해 객체 형태로 제공해야한다. <code class=\"language-text\">lighthouse</code>로 PWA 관련 리포트를 확인해가면서 적용했는데, <code class=\"language-text\">theme-color</code> 메타태그가 없다는 메세지가 보여서 함께 설정해줬다.</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> metadata<span class=\"token operator\">:</span> Metadata <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  title<span class=\"token operator\">:</span> <span class=\"token string\">'Fryfolio'</span><span class=\"token punctuation\">,</span>\n  description<span class=\"token operator\">:</span> <span class=\"token string\">'developer kyurankim portfolio'</span><span class=\"token punctuation\">,</span>\n  themeColor<span class=\"token operator\">:</span> <span class=\"token string\">'#ffc211'</span><span class=\"token punctuation\">,</span>\n  icons<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    other<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n      <span class=\"token punctuation\">{</span>\n        url<span class=\"token operator\">:</span> <span class=\"token string\">'/icons/splashscreens/iphone5_splash.png'</span><span class=\"token punctuation\">,</span>\n        media<span class=\"token operator\">:</span>\n          <span class=\"token string\">'(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)'</span><span class=\"token punctuation\">,</span>\n        rel<span class=\"token operator\">:</span> <span class=\"token string\">'apple-touch-startup-image'</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token operator\">...</span>\n    <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<br />\n<blockquote>\n<p>Next.js 14부터는 metadata 객체의 themeColor 필드가 사용되지 않고, viewport 객체를 통해 사용해야한다고 한다. <a href=\"https://nextjs.org/docs/app/api-reference/functions/generate-metadata#themecolor\">(참고)</a></p>\n</blockquote>\n<h2 id=\"5-빌드--서버-실행\" style=\"position:relative;\"><a href=\"#5-%EB%B9%8C%EB%93%9C--%EC%84%9C%EB%B2%84-%EC%8B%A4%ED%96%89\" aria-label=\"5 빌드  서버 실행 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. 빌드 &#x26; 서버 실행</h2>\n<p>이제 구색은 어느정도 갖춰진 것 같다. 다시 프로젝트를 빌드를 하고, dev server를 실행시켜보면</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> build <span class=\"token operator\">&amp;&amp;</span> <span class=\"token function\">yarn</span> dev</code></pre></div>\n<p>앱을 설치할 수 있는 아이콘이 url 표시줄에 보인다! 🥺</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 78.33333333333333%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAABYlAAAWJQFJUiTwAAAC9UlEQVQ4y6WU+0sUURTHJ83VECQoKmvVrAjLV2X90uOnCKLXX5BNr/nFICIiEDHEsrKInkR/Q9Djhx5E6EI/9FBKrE3T2fVRuTrra83W3Zk59347M7s+yiKoA1/mzLn3fO65954ZJT8rK9+bnVmxfcfWI9u2bNFKS4q1sg3rtXkZ6ZqiKLPkycjQ5npStdTUFC0tLU1LT/doKSlzjmRmZlasKShYrixbsvRQTq4XJetKUVRcitUFhcjJzYeX5bwXFhWzSlC2cZPrexcvQm72CuSvWAWvNwfZy7w8Pw9rC528PFU5ffKYevn8GdSfrTLr66rpwrlqqqk8QU8fP6TB0RHqDfXT6HiULIDa9QBdrr9It27cppvXr9C1SzXEuXT1Uq1550Y9Kk8dL1cG9NcqvnUB0V4bVp+EGJTAuARFpGl/lyPjURkTUsYByVAem6mIFKMd0h5qtx1GqONVuaK3NKr2cAc4SDQxJEkICCJE4yaipoWYbWMkFsfQRAwRFvG74DnuPCFhxcakFekle/gTOt81lCuBlgYVER2YGCReUrLBMZsfcQGYNmCZJkzLgs0wZ3ymktUS4sPQWxxg21sVdtSJ0iROGC8h3lVBttZCRr8iYRKTNrkoElDp5rLpne0MDHariTHhBKUYboX07QN8uyEfLAc17uYjsKZBDuRn30GSs6AeCDAwEFDhDpK7ZfHpNmTjLsjXR4FnWyHueSFG2pJAgV9NJkpMVKjrSaA7QIkKvzzmylYCT8qAu/NBTzZDxCN/AcrfAd1gYrkPdRCPSkDPd4IGXiYzBaScRZvespzaclBNHi7JGdcmzHG3fWYkzrqQqUuZqrCDgXrngeQhWyxuYe4uQdxhYB8J343/Qc487izJx6K3+PYr3R9eHIY9hn83btT4EH9cXehq9R1Umnz394aDTd1Gz8f3Ruiz3zAGWMaUwuGwPxQKuXJ8Nz7Q7zf6evxG70e/EWz2G/qr9+Fgc9cb34M9/EdSPKwFrIX/KYfh+QGlYt+D8SeXoQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"chrome-pwa-result\"\n        title=\"chrome-pwa-result\"\n        src=\"/static/a90da79bbaeb0ce991765774576b8224/37523/chrome-pwa.png\"\n        srcset=\"/static/a90da79bbaeb0ce991765774576b8224/e9ff0/chrome-pwa.png 180w,\n/static/a90da79bbaeb0ce991765774576b8224/f21e7/chrome-pwa.png 360w,\n/static/a90da79bbaeb0ce991765774576b8224/37523/chrome-pwa.png 720w,\n/static/a90da79bbaeb0ce991765774576b8224/302a4/chrome-pwa.png 1080w,\n/static/a90da79bbaeb0ce991765774576b8224/07a9c/chrome-pwa.png 1440w,\n/static/a90da79bbaeb0ce991765774576b8224/eb645/chrome-pwa.png 2500w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<p>모바일에서도 잘 동작한다! 😆<br>\n아이콘과 스플래쉬 화면 수정이 필요해보이지만.. 꽤 귀엽다.. 🫢</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 720px; \"\n    >\n      <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 91.11111111111111%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAYAAABb0P4QAAAACXBIWXMAAAsTAAALEwEAmpwYAAAE7ElEQVQ4y02UD1SNZxzHn3PYIf9PjUk2y9aUQxpjJxrLUpYT2UqNs45iSaRuqetkjaiVrGbD1S3V6vbHW0QqonVzGOJEolwyw1ExliK3e+/7PPf57ulqp/3e8z3v+z7P+37O9/f8fs9DyvzWkkeeseszEjfnZbrHHyywTlflTsxXHZ1ap2pe/OjQs5Anhx76ssn4m4xprnE7UHHKI/N13WyVXqivfo7qRc3HBx8cnZHTfcYlKnPrO4RUeoWRVrfvKov9IpBhvxE/jYhDxui9yB4vQTunCe0h7egK7poN5Ezq7jiLjk4t6NNTMHVWC1Wh73EVuu5XwtBefaW+pogQKTGeaN3XlNwszkKCXaAxmgRS5dBImjQsg5bY1rC2wDbWG9U5C8BEzmHo05vFDVS8U70JtNcAk0FGf9QKEbJ32gpy0tlXUrsHY8tYDxo2xJtvGhrElUN/4IV2J3A/VIfWX/a7iI9tzYzKVNaLR87Lykr4ufpaweasf4xzpmXMTMjP1u7k2DQfKXncQoRbLaJhw72wySoQCaO+53WuF3E77SjSKokFyM1UNvXeBQw63nClHDeaqgCjjpn0D/odai0Ok6Z4EY3Dcmm37RIoRiyh26wCkPZ2Amrm1/Br4WegznRE0h9vgOZ+4CsdqLGVPzmrwT+XyyEbW5n8+q9B4G6nlSTbyV/a7xiEI64p9Pw3BWhS5KE2Nppvj7FG6nECTeP/gL13IOtb+MPzpei8VgXa18JMAkiZSNksgJf2akiV/3ZJp1Kj61IsvV09D0VpIxEVR7hSI2BX30dxg9OblDmV5dc6GLqvcVNfC0z6WzB2Nwrg/UEgcIH0nC+UOhqW4GIuoXV7CKoT38KeRMKTj49FZfMaVFz9dgBolo2GHlD5pVjOXgyIcWYYTNluCCH1RRGS76zRcLIaTudOGAM/ZxskrrTjqbvtUdecjD87iixAk2ySqbDRX2YMBrMMcK4VIpbw8VgqjZ/wIcbYTKajrSdj2IgJsB41kQd4L0R2wQ6EKWMtQKPRKDrODDOn4l+GATHh3OKQQwAdZzoTH59VkrPLp5jywXT6rr0TbN/7CKOsbfkMl3lYFhAu8hhuAcoiLN7M/3PIxGUecNi/hm6LPMiG0M2Sl/cKzJu/kLrMdcV05zmwd3DiTjOdER4ZA5upbgNVNsuvcAfPcYV3XDiBp42n8RJNzIj/2sZESEhoKNmxY6e0LnQDfP386ZfLV+ALT0/M/8yNL3BzQ0rKLsQnJFqAemOfXKjaiqL87fyIKgv5KemIS/JlqTlrRXGgPaa+RUh8TBzZl54uJcTGY+P6UBodvpnHbYvnfqtW81VBq5H9mxo3L/1uAfYZDPLW4C0IWLyG+3+1jn/tvZov+MSVRSpDwGRos7bdI6SwuZQUlWtK0ut+xY+lGUZFxT6WpY5jOeoN9Ey2irVUlZuvP9b1Hw62lFKjh9dSPs7Ghtrb2zMHh+nM0XmKKTw6UOwY1O4KaiBk58sDpORc8Ull6y4kX1Ah+HoujkkbUVcVgGdFeegpK8FF8wtxfGESYxT7CiIQkbQIilSxVVM8EZP+OfJPKyGmGs6W6QipKD1CairLl0kl+crivNzIrIMHFIWaw4qKck3UucbLirvt9xRtl2vHC+BI0R6RQFt0J45HNT5RK248P6zoQW0UcC9O1NlPlJz8Czaqw8XFbHS8AAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"iphone-pwa-result\"\n        title=\"iphone-pwa-result\"\n        src=\"/static/745bbe01d92bd2fbc466fb64dec4ab8f/37523/iphone-pwa.png\"\n        srcset=\"/static/745bbe01d92bd2fbc466fb64dec4ab8f/e9ff0/iphone-pwa.png 180w,\n/static/745bbe01d92bd2fbc466fb64dec4ab8f/f21e7/iphone-pwa.png 360w,\n/static/745bbe01d92bd2fbc466fb64dec4ab8f/37523/iphone-pwa.png 720w,\n/static/745bbe01d92bd2fbc466fb64dec4ab8f/302a4/iphone-pwa.png 1080w,\n/static/745bbe01d92bd2fbc466fb64dec4ab8f/07a9c/iphone-pwa.png 1440w,\n/static/745bbe01d92bd2fbc466fb64dec4ab8f/3a793/iphone-pwa.png 2973w\"\n        sizes=\"(max-width: 720px) 100vw, 720px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n    </span></p>\n<h2 id=\"마무리\" style=\"position:relative;\"><a href=\"#%EB%A7%88%EB%AC%B4%EB%A6%AC\" aria-label=\"마무리 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>마무리</h2>\n<p>PWA를 만들었으니, 그 목적에 부합하게 다양한 모바일 디바이스에 대응이 가능하도록 리팩터링을 해야될 것 같다. 그리고 앱뷰로 디자인된 프로젝트를 하나 진행하고 있는데, 여유가 된다면 PWA로 만들어보면서 서비스워커, 캐싱 등도 적절히 사용해봐야겠다!</p>\n<h2 id=\"참고하면-좋을-글\" style=\"position:relative;\"><a href=\"#%EC%B0%B8%EA%B3%A0%ED%95%98%EB%A9%B4-%EC%A2%8B%EC%9D%84-%EA%B8%80\" aria-label=\"참고하면 좋을 글 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>참고하면 좋을 글</h2>\n<ul>\n<li><a href=\"https://noogoonaa.tistory.com/110\">PWA 시작하기 - Next.js 프로젝트로 PWA 만들기</a></li>\n<li><a href=\"https://yozm.wishket.com/magazine/detail/537/\">[요즘IT] 프론트엔드 개발자가 PWA 알아야 하는 이유</a></li>\n<li><a href=\"https://yozm.wishket.com/magazine/detail/1969/\">[요즘IT] 프로그레시브 웹 앱(PWA)란 무엇이며, 왜 필요한가?</a></li>\n</ul>\n<div class=\"table-of-contents\">\n<ul>\n<li><a href=\"#pwa-progressive-web-apps\">PWA (Progressive Web Apps)</a></li>\n<li><a href=\"#1-next-pwa-%ED%8C%A8%ED%82%A4%EC%A7%80-%EC%84%A4%EC%B9%98\">1. next-pwa 패키지 설치</a></li>\n<li><a href=\"#2-next-config-%EC%84%A4%EC%A0%95\">2. next config 설정</a></li>\n<li>\n<p><a href=\"#3-manifest-%ED%8C%8C%EC%9D%BC%EA%B3%BC-%EC%95%84%EC%9D%B4%EC%BD%98-%EC%B6%94%EA%B0%80\">3. manifest 파일과 아이콘 추가</a></p>\n<ul>\n<li><a href=\"#%EC%83%9D%EC%84%B1%ED%95%98%EA%B8%B0\">생성하기</a></li>\n<li><a href=\"#%EC%A0%80%EC%9E%A5%ED%95%98%EA%B8%B0\">저장하기</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#4-metadata-%EC%A0%9C%EA%B3%B5\">4. metadata 제공</a></p>\n<ul>\n<li><a href=\"#%EC%95%84%EC%9D%B4%EC%BD%98\">아이콘</a></li>\n<li><a href=\"#%EC%8A%A4%ED%94%8C%EB%9E%98%EC%89%AC-%EC%8A%A4%ED%81%AC%EB%A6%B0\">스플래쉬 스크린</a></li>\n</ul>\n</li>\n<li><a href=\"#5-%EB%B9%8C%EB%93%9C--%EC%84%9C%EB%B2%84-%EC%8B%A4%ED%96%89\">5. 빌드 &#x26; 서버 실행</a></li>\n<li><a href=\"#%EB%A7%88%EB%AC%B4%EB%A6%AC\">마무리</a></li>\n<li><a href=\"#%EC%B0%B8%EA%B3%A0%ED%95%98%EB%A9%B4-%EC%A2%8B%EC%9D%84-%EA%B8%80\">참고하면 좋을 글</a></li>\n</ul>\n</div>","frontmatter":{"date":"October 30, 2023","title":"Next.js 프로젝트에 PWA 기술 적용하기","categories":"프론트엔드 Next.js","author":"Fry","emoji":"📱"},"fields":{"slug":"/nextjs-pwa/"}},"prev":null,"site":{"siteMetadata":{"siteUrl":"https://gxxrxn.github.io","comments":{"utterances":{"repo":"gxxrxn/gxxrxn.github.io"}}}}},"pageContext":{"slug":"/nextjs-rewrites/","nextSlug":"/nextjs-pwa/","prevSlug":""}},"staticQueryHashes":["1073350324","2938748437"]}